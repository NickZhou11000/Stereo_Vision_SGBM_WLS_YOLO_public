# stereo_vision_SGBM_WLS_YOLO
A self practice demo for the Robotic Vision class, using SGBM (Semi Global Block Matching) and WLS filter (Weighted Least Squares) for the depth detection and use yolo v8 for object detection.

## How to Use

This project consists of several Python scripts that work together to perform stereo vision calibration, depth estimation, object detection, and a combined detection pipeline.

### 1. Stereo Calibration (`enhanced_stereo_calibration.py`)

This script calibrates the stereo camera system using a set of chessboard images.

- **Setup**:
    - Place your left and right calibration images in respective folders (e.g., `./dataset2/left/` and `./dataset2/right/`).
    - Adjust `chessboard_size`, `frame_size`, and `square_size_mm` in the script if your setup differs from the defaults.
- **Execution**:
    ```bash
    python enhanced_stereo_calibration.py
    ```
- **Output**: This will generate a calibration file (e.g., `enhanced_stereo_map.xml`) containing the stereo calibration parameters. It also displays calibration results and error analysis.

### 2. Stereo Vision Processing (`enhanced_stereo_vision.py`)

This script uses the calibration file to rectify stereo images, compute disparity and depth maps, and generate a 3D point cloud.

- **Prerequisites**: Requires a calibration file (e.g., `enhanced_stereo_map.xml`) generated by `enhanced_stereo_calibration.py`.
- **Setup**:
    - Ensure the calibration file path in the script matches the generated one.
    - Update image paths for `left_image_path` and `right_image_path` in the `main()` function if you want to process different images.
- **Execution**:
    ```bash
    python enhanced_stereo_vision.py
    ```
- **Output**: Displays rectified images, disparity map, depth map, and visualizes the 3D point cloud. It can also save the point cloud to a `.ply` file.

### 3. YOLOv8 Object Detection (`yolo_v8_model.py`)

This script loads a pre-trained YOLOv8 model and performs object detection on a sample image.

- **Setup**:
    - By default, it uses `yolov8n.pt`. If this file is not present, the `ultralytics` library will attempt to download it. You can specify a different model path.
    - The example usage loads an image named `test_image.jpg`. Ensure this image exists or modify the script to load your desired image.
- **Execution**:
    ```bash
    python yolo_v8_model.py
    ```
- **Output**: Prints detected objects' class names, confidences, and bounding boxes to the console. It also displays the image with bounding boxes drawn around detected objects.

### 4. Detection Pipeline (`detection_pipeline.py`)

This script integrates the stereo vision system and the YOLOv8 object detector to perform 3D object detection.

- **Prerequisites**:
    - Requires a calibration file (e.g., `enhanced_stereo_map.xml`).
    - Requires a YOLO model file (e.g., `yolov8n.pt`).
- **Setup**:
    - In the `if __name__ == "__main__":` block, update `CALIBRATION_FILE`, `LEFT_IMAGE_PATH`, `RIGHT_IMAGE_PATH`, and `YOLO_MODEL_PATH` as needed.
- **Execution**:
    ```bash
    python detection_pipeline.py
    ```
- **Output**: Processes the input stereo image pair, performs object detection, estimates the depth of detected objects, and can display the left image with detections and depth information. It also prints details of the detected objects.

### General Notes:
- Ensure all required Python packages are installed (e.g., `opencv-python`, `numpy`, `matplotlib`, `ultralytics`, `torch`). You might need to create a `requirements.txt` file and install them using `pip install -r requirements.txt`.
- The scripts often use relative paths. Ensure you run them from the `stereo_vision_python` directory or adjust paths accordingly.
- Some scripts include example image paths (e.g., from `dataset2/`). Make sure these datasets are available or update the paths to your own images.
